(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{128:function(e,n){},130:function(e,n){},171:function(e,n,t){},172:function(e,n,t){},174:function(e,n,t){},175:function(e,n,t){"use strict";t.r(n);var a,r,c,s,i,o,l,u,d,b=t(0),j=t.n(b),m=t(52),h=t.n(m),g=t(31),O=t(24),p=t(10),x=t(110),v=t(193),f=t(195),w=t(189),k=t(42),y=t(19),S=t(35),I=t(13),_=t(185),$=t(186),N=t(192),T=t(104),C=t(105),U=t(187),B=t(196),D=(t(118),t(20)),L=t(21),F=t(80),P=new(function(){function e(){Object(D.a)(this,e)}return Object(L.a)(e,[{key:"getProfile",value:function(){return Object(F.a)(this.getToken())}},{key:"loggedIn",value:function(){var e=this.getToken();return!(!e||this.isTokenExpired(e))}},{key:"isTokenExpired",value:function(e){return Object(F.a)(e).exp<Date.now()/1e3&&(localStorage.removeItem("id_token"),!0)}},{key:"getToken",value:function(){return localStorage.getItem("id_token")}},{key:"login",value:function(e){localStorage.setItem("id_token",e),window.location.assign("/")}},{key:"logout",value:function(){localStorage.removeItem("id_token"),window.location.reload()}}]),e}()),W=t(198),A=t(184),E=t(32),Y=t(191),z=Object(Y.a)(a||(a=Object(E.a)(["\n  mutation login($email: String!, $password: String!) {\n    login(email: $email, password: $password) {\n      token\n      user {\n        _id\n        username\n      }\n    }\n  }\n"]))),q=Object(Y.a)(r||(r=Object(E.a)(["\n  mutation addUser($username: String!, $email: String!, $password: String!) {\n    addUser(username: $username, email: $email, password: $password) {\n      token\n      user {\n        _id\n        username\n      }\n    }\n  }\n"]))),R=Object(Y.a)(c||(c=Object(E.a)(["\n  mutation addBusiness($name: String!, $yelpId: String!, $url: String!, $location: String!, $imgUrl: String) {\n    addBusiness(name: $name, yelpId: $yelpId, url: $url, location: $location, imgUrl: $imgUrl) {\n      _id\n      name\n      yelpId\n      url\n      location\n      imgUrl\n      comments {\n        _id\n        commentText\n      }\n    }\n  }\n"]))),V=(Object(Y.a)(s||(s=Object(E.a)(["\nmutation addComment($businessId: ID!, $commentText: String!) {\n  addComment(businessId: $businessId, commentText: $commentText) {\n    _id\n    name\n    yelpId\n    url\n    location\n    comments {\n      _id\n      commentText\n    }\n  }\n}"]))),Object(Y.a)(i||(i=Object(E.a)(["\nmutation removeBusiness($businessId: ID!) {\n  removeBusiness(businessId: $businessId) {\n    _id\n    name\n    yelpId\n    url\n    location\n    imgUrl\n    comments {\n      _id\n      commentText\n    }\n  }\n}\n"])))),J=(Object(Y.a)(o||(o=Object(E.a)(["\nmutation removeComment($businessId: ID!, $commentId: ID!) {\n  removeComment(businessId: $businessId, commentId: $commentId) {\n    _id\n    name\n    yelpId\n    url\n    location\n    comments {\n      _id\n      commentAuthor\n    }\n  }\n}"]))),Object(Y.a)(l||(l=Object(E.a)(["\n  query me {\n    me {\n      _id\n      username\n      email\n      businesses {\n        _id\n        name\n        location\n        imgUrl\n        yelpId\n        url\n      }\n      comments {\n        _id\n        commentText\n        createdAt\n      }\n    }\n  }\n"])))),Q=(Object(Y.a)(u||(u=Object(E.a)(["\n  query user($username: String!) {\n    user(username: $username) {\n      _id\n      username\n      email\n      business {\n        _id\n        name\n      }\n      comments {\n        _id\n        commentText\n        createdAt\n      }\n    }\n  }\n"]))),Object(Y.a)(d||(d=Object(E.a)(["\n  query Businesses {\n    businesses {\n      _id\n      name\n      location\n      url\n    }\n  }\n"]))),t(3)),X=function(){var e=Object(b.useState)([]),n=Object(I.a)(e,2),t=n[0],a=n[1],r=Object(b.useState)(""),c=Object(I.a)(r,2),s=c[0],i=c[1],o=Object(W.a)(J),l=(o.loading,o.data),u=(null===l||void 0===l?void 0:l.me)||{};console.log(u.businesses);var d=Object(b.useState)(localStorage.getItem("saved_businesses")?JSON.parse(localStorage.getItem("saved_businesses")):[]),j=Object(I.a)(d,2),m=j[0],h=j[1],g=Object(A.a)(R),O=Object(I.a)(g,2),p=O[0];O[1].error;Object(b.useEffect)((function(){return function(){var e;(e=m).length?localStorage.setItem("saved_businesses",JSON.stringify(e)):localStorage.removeItem("saved_businesses")}}));var x=function(){var e=Object(S.a)(Object(y.a)().mark((function e(n){var t,r,c;return Object(y.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),console.log("here"),s){e.next=4;break}return e.abrupt("return",!1);case 4:return e.prev=4,e.next=7,o=s,console.log("hitAPI"),fetch("".concat("https://cors-anywhere.herokuapp.com/","https://api.yelp.com/v3/businesses/search?term=dogs_allowed&location=").concat(o),{method:"GET",headers:{authorization:"Bearer sFDrQ2pCQos8PDSDDwhIcVDKCUPVRHBWQf8OUcjX3PKW-d6e0S_uxIlVXXbHGFf96nF8w-VqDPw_2ZzSU-5-ievJLv_YlGpOQkamfNYe3l5k3b0BnlP2gTXQ5ZyLYnYx"}});case 7:if(t=e.sent,console.log(t),t.ok){e.next=11;break}throw new Error("Could not complete search request");case 11:return e.next=13,t.json();case 13:r=e.sent,console.log(r),c=null===r||void 0===r?void 0:r.businesses.map((function(e){return{name:e.name,id:e.id,image:e.image_url,rating:e.rating,street:e.location.address1,city:e.city,zip:e.zip_code,url:e.url}})),a(c),i(""),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(4),console.error(e.t0);case 23:case"end":return e.stop()}var o}),e,null,[[4,20]])})));return function(n){return e.apply(this,arguments)}}(),v=function(){var e=Object(S.a)(Object(y.a)().mark((function e(n){var a;return Object(y.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.find((function(e){return e.id===n})),console.log(a),P.loggedIn()?P.getToken():null){e.next=5;break}return e.abrupt("return",!1);case 5:return e.prev=5,e.next=8,p({variables:{name:a.name,yelpId:a.id,url:a.url,location:a.street,imgUrl:a.image}});case 8:h([].concat(Object(k.a)(m),[a.bizId])),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(5),console.error(e.t0);case 14:case"end":return e.stop()}}),e,null,[[5,11]])})));return function(n){return e.apply(this,arguments)}}();return Object(Q.jsxs)(Q.Fragment,{children:[Object(Q.jsx)(_.a,{fluid:!0,className:"text-light bg-danger",children:Object(Q.jsxs)($.a,{children:[Object(Q.jsx)("h1",{children:"Search For Dog Friendly Businesses Nearby"}),Object(Q.jsx)(N.a,{onSubmit:x,children:Object(Q.jsxs)(N.a.Row,{children:[Object(Q.jsx)(T.a,{xs:12,md:8,children:Object(Q.jsx)(N.a.Control,{name:"searchInput",value:s,onChange:function(e){return i(e.target.value)},type:"text",size:"lg",placeholder:"Search by City, State or Zip"})}),Object(Q.jsx)(T.a,{xs:12,md:4,children:Object(Q.jsx)(C.a,{type:"submit",variant:"success",size:"lg",children:"Submit Search"})})]})})]})}),Object(Q.jsxs)($.a,{children:[Object(Q.jsx)("h2",{children:t.length?"Viewing ".concat(t.length," results:"):"Search to begin"}),Object(Q.jsx)(U.a,{children:t.map((function(e){return Object(Q.jsxs)(B.a,{border:"dark",children:[e.image?Object(Q.jsx)(B.a.Img,{src:e.image,alt:"The cover for ".concat(e.name),variant:"top"}):null,Object(Q.jsxs)(B.a.Body,{children:[Object(Q.jsx)(B.a.Title,{children:e.name}),Object(Q.jsx)("p",{className:"small",children:"Location: "}),Object(Q.jsx)(B.a.Text,{children:e.street}),P.loggedIn()&&Object(Q.jsx)(C.a,{disabled:null===m||void 0===m?void 0:m.some((function(n){return n===e.id})),className:"btn-block btn-info",onClick:function(){return v(e.id)},children:null!==m&&void 0!==m&&m.some((function(n){return n===e.id}))?"This business has already been saved!":"Save this Business!"})]})]},e.id)}))})]})]})},G=t(190),Z=t(50),H=function(e){var n=Object(b.useState)({email:"",password:""}),t=Object(I.a)(n,2),a=t[0],r=t[1],c=Object(A.a)(z),s=Object(I.a)(c,2),i=s[0],o=s[1],l=o.error,u=o.data,d=function(e){var n=e.target,t=n.name,c=n.value;r(Object(g.a)(Object(g.a)({},a),{},Object(Z.a)({},t,c)))},j=function(){var e=Object(S.a)(Object(y.a)().mark((function e(n){var t,c;return Object(y.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),console.log(a),e.prev=2,e.next=5,i({variables:Object(g.a)({},a)});case 5:t=e.sent,c=t.data,P.login(c.login.token),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),console.error(e.t0);case 13:r({email:"",password:""});case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(n){return e.apply(this,arguments)}}();return Object(Q.jsx)("main",{className:"flex-row justify-center mb-4",children:Object(Q.jsx)("div",{className:"col-12",children:Object(Q.jsxs)("div",{className:"card",children:[Object(Q.jsx)("h4",{className:"card-header bg-dark text-light p-12",children:"Login"}),Object(Q.jsxs)("div",{className:"card-body",children:[u?Object(Q.jsxs)("p",{children:["Success! You may now head"," ",Object(Q.jsx)(O.b,{to:"/",children:"back to the homepage."})]}):Object(Q.jsxs)("form",{onSubmit:j,children:[Object(Q.jsx)("input",{className:"form-input",placeholder:"Your email",name:"email",type:"email",value:a.email,onChange:d}),Object(Q.jsx)("input",{className:"form-input",placeholder:"******",name:"password",type:"password",value:a.password,onChange:d}),Object(Q.jsx)("button",{className:"btn btn-block btn-primary",style:{cursor:"pointer"},type:"submit",children:"Submit"})]}),l&&Object(Q.jsx)("div",{className:"my-3 p-3 bg-danger text-white",children:l.message})]})]})})})},K=function(){var e=Object(b.useState)({username:"",email:"",password:""}),n=Object(I.a)(e,2),t=n[0],a=n[1],r=Object(A.a)(q),c=Object(I.a)(r,2),s=c[0],i=c[1],o=i.error,l=i.data,u=function(e){var n=e.target,r=n.name,c=n.value;a(Object(g.a)(Object(g.a)({},t),{},Object(Z.a)({},r,c)))},d=function(){var e=Object(S.a)(Object(y.a)().mark((function e(n){var a,r;return Object(y.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),console.log(t),e.prev=2,e.next=5,s({variables:Object(g.a)({},t)});case 5:a=e.sent,r=a.data,P.login(r.addUser.token),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),console.error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(n){return e.apply(this,arguments)}}();return Object(Q.jsx)("main",{className:"flex-row justify-center mb-4",children:Object(Q.jsx)("div",{className:"col-12",children:Object(Q.jsxs)("div",{className:"card",children:[Object(Q.jsx)("h4",{className:"card-header bg-dark text-light p-2",children:"Sign Up"}),Object(Q.jsxs)("div",{className:"card-body",children:[l?Object(Q.jsxs)("p",{children:["Success! You may now head"," ",Object(Q.jsx)(O.b,{to:"/",children:"back to the homepage."})]}):Object(Q.jsxs)("form",{onSubmit:d,children:[Object(Q.jsx)("input",{className:"form-input",placeholder:"Your username",name:"username",type:"text",value:t.name,onChange:u}),Object(Q.jsx)("input",{className:"form-input",placeholder:"Your email",name:"email",type:"email",value:t.email,onChange:u}),Object(Q.jsx)("input",{className:"form-input",placeholder:"******",name:"password",type:"password",value:t.password,onChange:u}),Object(Q.jsx)("button",{className:"btn btn-block btn-primary",style:{cursor:"pointer"},type:"submit",children:"Submit"})]}),o&&Object(Q.jsx)("div",{className:"my-3 p-3 bg-danger text-white",children:o.message})]})]})})})},M=function(){var e=Object(W.a)(J),n=e.loading,t=e.data,a=Object(A.a)(V),r=Object(I.a)(a,2),c=r[0],s=(r[1].error,(null===t||void 0===t?void 0:t.me)||{});if(n)return Object(Q.jsx)("div",{children:"Loading..."});if(null===s||void 0===s||!s.username)return Object(Q.jsx)("h4",{children:"You need to be logged in to see this. Use the navigation links above to sign up or log in!"});var i=function(){var e=Object(S.a)(Object(y.a)().mark((function e(n){return Object(y.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(P.loggedIn()?P.getToken():null){e.next=3;break}return e.abrupt("return",!1);case 3:return e.prev=3,e.next=6,c({variables:{businessId:n}});case 6:return window.location.reload(!1),e.abrupt("return");case 10:throw e.prev=10,e.t0=e.catch(3),new Error(e.t0.message);case 13:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(n){return e.apply(this,arguments)}}();return console.log(s.businesses),Object(Q.jsx)("div",{children:Object(Q.jsxs)($.a,{children:[Object(Q.jsxs)("h2",{children:["Viewing ",s.username,"'s profile."]}),Object(Q.jsxs)("div",{children:[Object(Q.jsx)("h3",{children:"Favorite Businesses"}),Object(Q.jsx)(U.a,{children:s.businesses.map((function(e){return Object(Q.jsxs)(B.a,{style:{width:"20rem"},children:[e.imgUrl?Object(Q.jsx)(B.a.Img,{src:e.imgUrl,alt:"The cover for ".concat(e.name),variant:"top"}):null,Object(Q.jsx)("a",{href:e.url,target:"_blank",rel:"noreferrer",children:Object(Q.jsx)(B.a.Title,{children:e.name})}),Object(Q.jsx)(B.a.Text,{children:e.location}),Object(Q.jsx)(C.a,{variant:"primary",onClick:function(){return i(e._id)},children:"Remove from favorites"})]},e._id)}))})]})]})})},ee=t(194),ne=(t(171),t.p+"static/media/paw2.6fc21eb8.png"),te=function(){return Object(Q.jsx)(Q.Fragment,{children:Object(Q.jsx)(G.a,{bg:"white",variant:"light",expand:"lg",children:Object(Q.jsxs)($.a,{fluid:!0,children:[Object(Q.jsxs)(G.a.Brand,{as:O.b,to:"/",children:[Object(Q.jsx)("img",{src:ne,width:"50",height:"50"}),Object(Q.jsx)("h3",{children:"PAW PATROLLER"}),Object(Q.jsx)("h7",{children:"Dog Friendly Business Search"})]}),Object(Q.jsx)(G.a.Toggle,{"aria-controls":"navbar"}),Object(Q.jsx)(G.a.Collapse,{id:"navbar",children:Object(Q.jsxs)(ee.a,{className:"ml-auto",children:[Object(Q.jsx)(ee.a.Link,{as:O.b,to:"/",children:"Search"}),P.loggedIn()?Object(Q.jsxs)(Q.Fragment,{children:[Object(Q.jsxs)(ee.a.Link,{as:O.b,to:"/me",children:[P.getProfile().data.username,"'s profile"]}),Object(Q.jsx)(ee.a.Link,{onClick:P.logout,children:"Logout"})]}):Object(Q.jsxs)(Q.Fragment,{children:[Object(Q.jsx)(ee.a.Link,{as:O.b,to:"/login",children:"Login"}),Object(Q.jsx)(ee.a.Link,{as:O.b,to:"/signup",children:"Sign Up"})]})]})}),Object(Q.jsxs)("div",{children:[Object(Q.jsx)(C.a,{variant:"dark",id:"buttonInstall",children:"Dark"})," "]})]})})})},ae=t(108),re=(t(172),Object(x.a)({uri:"/graphql"})),ce=Object(ae.a)((function(e,n){var t=n.headers,a=localStorage.getItem("id_token");return{headers:Object(g.a)(Object(g.a)({},t),{},{authorization:a?"Bearer ".concat(a):""})}})),se=new v.a({link:ce.concat(re),cache:new f.a});var ie=function(){return Object(Q.jsx)(w.a,{client:se,children:Object(Q.jsxs)(O.a,{children:[Object(Q.jsx)(te,{}),Object(Q.jsxs)("div",{className:"Nav",children:[Object(Q.jsx)(G.a.Brand,{}),Object(Q.jsx)("div",{className:"App",children:Object(Q.jsxs)(p.c,{children:[Object(Q.jsx)(p.a,{path:"/",element:Object(Q.jsx)(X,{})}),Object(Q.jsx)(p.a,{path:"/login",element:Object(Q.jsx)(H,{})}),Object(Q.jsx)(p.a,{path:"/signup",element:Object(Q.jsx)(K,{})}),Object(Q.jsx)(p.a,{path:"/me",element:Object(Q.jsx)(M,{})})]})})]})]})})},oe=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,199)).then((function(n){var t=n.getCLS,a=n.getFID,r=n.getFCP,c=n.getLCP,s=n.getTTFB;t(e),a(e),r(e),c(e),s(e)}))},le=(t(173),t(174),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function ue(e,n){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;null!=t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),n&&n.onUpdate&&n.onUpdate(e)):(console.log("Content is cached for offline use."),n&&n.onSuccess&&n.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}h.a.render(Object(Q.jsx)(j.a.StrictMode,{children:Object(Q.jsx)(ie,{})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var n="".concat("","/service-worker.js");le?(!function(e,n){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(t){var a=t.headers.get("content-type");404===t.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):ue(e,n)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(n,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):ue(n,e)}))}}(),oe()}},[[175,1,2]]]);
//# sourceMappingURL=main.2aa7df48.chunk.js.map